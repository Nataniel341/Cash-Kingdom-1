<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Cash Kingdom ‚Äî Turbo V3</title>
<style>
/* --- SETUP I ZMIENNE --- */
:root {
  --bg-color: #050510;
  --panel-bg: rgba(20, 20, 35, 0.75); /* P√≥≈Çprzezroczyste t≈Ço paneli */
  --accent: #00ff88;
  --accent-glow: rgba(0, 255, 136, 0.6);
  --gold: #ffcc00;
  --danger: #ff4757;
  --text-main: #ffffff;
  --text-muted: #8ba0b3;
}

* { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

body, html {
  margin: 0; padding: 0; width: 100%; height: 100%;
  font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  color: var(--text-main);
  background: #000;
  overflow: hidden;
}

/* --- T≈ÅO GRY (CA≈ÅY EKRAN) --- */
#global-bg {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  z-index: 0;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  transition: background-image 0.5s ease-in-out;
  /* Domy≈õlne t≈Ço */
  background-image: linear-gradient(135deg, #0f0c29, #302b63, #24243e); 
}
#global-bg::after {
  content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.3); /* Przyciemnienie t≈Ça dla czytelno≈õci */
}

/* --- G≈Å√ìWNY UK≈ÅAD --- */
.app {
  position: relative;
  z-index: 1;
  max-width: 1200px;
  height: 100vh;
  margin: 0 auto;
  display: grid;
  grid-template-columns: 1fr 400px;
  grid-template-rows: auto 1fr auto;
  gap: 20px;
  padding: 20px;
}

/* --- NAG≈Å√ìWEK --- */
.header {
  grid-column: 1 / -1;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--panel-bg);
  backdrop-filter: blur(12px);
  padding: 15px 25px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}
.logo { font-size: 22px; font-weight: 800; color: var(--accent); display: flex; align-items: center; gap: 10px; text-transform: uppercase; letter-spacing: 1px; }

/* --- LEWA STRONA (KLIKANIE) --- */
.click-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  position: relative;
}

/* Przycisk G≈Ç√≥wny */
#clickBtn {
  width: 260px; height: 260px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffffff, #a8ffcc, #00d66f);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  box-shadow: 0 0 60px var(--accent-glow), inset -10px -10px 30px rgba(0,0,0,0.2);
  transition: transform 0.1s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
}
#clickBtn:active { transform: scale(0.92); }
#clickBtn img { width: 160px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4)); pointer-events: none; }

/* Efekt klikniƒôcia (Tekst) */
.float-text {
  position: absolute;
  color: #fff; font-weight: 800; font-size: 24px;
  text-shadow: 0 0 10px var(--accent);
  pointer-events: none;
  animation: floatUp 0.8s forwards;
}
@keyframes floatUp { 0% { opacity:1; transform:translateY(0) scale(1); } 100% { opacity:0; transform:translateY(-100px) scale(1.5); } }

/* Statystyki */
.stats-bar {
  display: flex; gap: 20px; margin-top: 30px;
  background: var(--panel-bg);
  padding: 10px 20px; border-radius: 50px;
  border: 1px solid rgba(255,255,255,0.1);
  backdrop-filter: blur(5px);
}
.stat { text-align: center; min-width: 100px; }
.stat-val { font-size: 24px; font-weight: 900; color: var(--accent); text-shadow: 0 0 10px rgba(0,255,136,0.3); }
.stat-label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

/* --- PRAWA STRONA (SKLEP) --- */
.shop-zone {
  background: var(--panel-bg);
  backdrop-filter: blur(15px);
  border-radius: 20px;
  border: 1px solid rgba(255,255,255,0.08);
  display: flex; flex-direction: column;
  overflow: hidden;
  box-shadow: -10px 0 40px rgba(0,0,0,0.4);
}

.tabs { display: flex; background: rgba(0,0,0,0.3); padding: 5px; }
.tab { 
  flex: 1; text-align: center; padding: 12px; cursor: pointer; 
  color: var(--text-muted); font-weight: 600; font-size: 13px;
  border-radius: 8px; transition: 0.3s;
}
.tab:hover { color: #fff; background: rgba(255,255,255,0.05); }
.tab.active { background: var(--accent); color: #000; box-shadow: 0 0 15px var(--accent-glow); }

.shop-list {
  flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px;
}
.shop-list::-webkit-scrollbar { width: 6px; }
.shop-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

/* Element Sklepu */
.item {
  display: flex; justify-content: space-between; align-items: center;
  background: rgba(255,255,255,0.03);
  padding: 12px; border-radius: 12px;
  border: 1px solid transparent;
  transition: 0.2s;
}
.item:hover { background: rgba(255,255,255,0.07); border-color: rgba(255,255,255,0.1); }

.item-left { display: flex; align-items: center; gap: 12px; }
.item-icon { font-size: 28px; filter: drop-shadow(0 0 8px rgba(255,255,255,0.3)); }
.item-info h4 { margin: 0; font-size: 15px; color: #fff; }
.item-info p { margin: 2px 0 0; font-size: 12px; color: var(--text-muted); }

.buy-btn {
  background: linear-gradient(90deg, #00d2ff, #3a7bd5);
  border: none; padding: 8px 14px; border-radius: 8px;
  color: #fff; font-weight: 700; font-size: 13px; cursor: pointer;
  min-width: 90px; text-align: center;
  box-shadow: 0 4px 10px rgba(0,100,255,0.3);
  transition: 0.2s;
}
.buy-btn:active { transform: scale(0.95); }
.buy-btn.locked { background: #333; color: #666; cursor: not-allowed; box-shadow: none; }
.buy-btn.owned { background: #2ecc71; color: #fff; pointer-events: none; box-shadow: none; cursor: default; }

/* --- PETY (DOLNY PASEK) --- */
.pets-zone {
  grid-column: 1 / -1;
  background: var(--panel-bg);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 15px;
  display: flex; gap: 15px; overflow-x: auto;
  align-items: center;
  min-height: 100px;
  border: 1px solid rgba(255,255,255,0.1);
}

.pet-card {
  min-width: 80px; height: 80px;
  background: rgba(255,255,255,0.05);
  border-radius: 12px;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  position: relative;
  animation: floatPet 3s ease-in-out infinite;
}
.pet-card img { width: 50px; height: 50px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.5)); }
.pet-name { position: absolute; bottom: 5px; font-size: 10px; background: rgba(0,0,0,0.6); padding: 2px 6px; border-radius: 8px; }

@keyframes floatPet { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-8px);} }

/* RWD */
@media (max-width: 800px) {
  .app { grid-template-columns: 1fr; grid-template-rows: auto auto 1fr auto; height: auto; min-height: 100vh; }
  .shop-zone { height: 400px; }
}
</style>
</head>
<body>

<div id="global-bg"></div>

<div class="app">
  
  <div class="header">
    <div class="logo">üëë Cash Kingdom <span style="font-size:12px; color:var(--accent); margin-left:5px; border:1px solid var(--accent); padding:2px 5px; border-radius:4px;">V3</span></div>
    <div style="font-size:12px; color:var(--text-muted)">AutoSave: ON</div>
  </div>

  <div class="click-zone">
    <div class="stats-bar">
      <div class="stat">
        <div class="stat-val" id="money">$0</div>
        <div class="stat-label">Got√≥wka</div>
      </div>
      <div class="stat">
        <div class="stat-val" id="perClick">1</div>
        <div class="stat-label">Za klik</div>
      </div>
      <div class="stat">
        <div class="stat-val" id="autoSec">0</div>
        <div class="stat-label">Na sek.</div>
      </div>
    </div>

    <div style="height: 40px;"></div>
    <div id="clickBtn">
      <img src="https://cdn-icons-png.flaticon.com/512/9499/9499088.png" alt="Coin">
    </div>
  </div>

  <div class="shop-zone">
    <div class="tabs">
      <div class="tab active" onclick="switchTab('upgrades')">Ulepszenia</div>
      <div class="tab" onclick="switchTab('pets')">Pety</div>
      <div class="tab" onclick="switchTab('backgrounds')">≈öwiaty</div>
    </div>
    <div id="shopList" class="shop-list"></div>
  </div>

  <div class="pets-zone" id="activePets">
    <div style="color:rgba(255,255,255,0.3); font-size:14px; margin:auto;">Kup pety, aby zobaczyƒá je tutaj!</div>
  </div>

</div>

<script>
// --- DANE GRY ---
const DB_KEY = "cash_kingdom_v3_turbo";

let game = {
  money: 0,
  clickLvl: 1,
  autoLvl: 0,
  pets: [],
  backgrounds: ['base'],
  currentBg: 'base'
};

// --- KONFIGURACJA SKLEPU ---
const UPGRADES = [
  { id: 'u1', name: 'Z≈Çoty Kursor', type: 'click', baseCost: 20, basePow: 1, icon: 'üëÜ' },
  { id: 'u2', name: 'Mega Wzmocnienie', type: 'click', baseCost: 500, basePow: 5, icon: '‚ö°' },
  { id: 'u3', name: 'Moc Boga', type: 'click', baseCost: 10000, basePow: 50, icon: 'üî±' },
  { id: 'a1', name: 'Autokliker V1', type: 'auto', baseCost: 100, basePow: 2, icon: 'ü§ñ' },
  { id: 'a2', name: 'Kopalnia BTC', type: 'auto', baseCost: 2500, basePow: 20, icon: 'üñ•Ô∏è' },
  { id: 'a3', name: 'Drukarnia', type: 'auto', baseCost: 15000, basePow: 100, icon: 'üè≠' }
];

const PETS = [
  { id: 'p1', name: 'Cyber Szczur', cost: 1000, power: 10, icon: 'https://cdn-icons-png.flaticon.com/512/4600/4600329.png' },
  { id: 'p2', name: 'Neon Kot', cost: 5000, power: 40, icon: 'https://cdn-icons-png.flaticon.com/512/3468/3468377.png' },
  { id: 'p3', name: 'Smok Ognia', cost: 50000, power: 250, icon: 'https://cdn-icons-png.flaticon.com/512/12426/12426615.png' },
  { id: 'p4', name: 'Duch Kosmosu', cost: 200000, power: 1000, icon: 'https://cdn-icons-png.flaticon.com/512/1089/1089472.png' }
];

const BACKGROUNDS = [
  { id: 'base', name: 'Baza Kosmiczna', cost: 0, img: 'https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=1920' },
  { id: 'city', name: 'Cyberpunk City', cost: 20000, img: 'https://images.unsplash.com/photo-1555680202-c86f0e12f086?q=80&w=1920' },
  { id: 'lava', name: 'JƒÖdro Ziemi', cost: 100000, img: 'https://images.unsplash.com/photo-1462332420958-a05d1e002413?q=80&w=1920' },
  { id: 'sky', name: 'Niebia≈Ñski Tron', cost: 500000, img: 'https://images.unsplash.com/photo-1506220926022-cc5c12acdb35?q=80&w=1920' }
];

let currentTab = 'upgrades';

// --- LOGIKA ---

function getClickPower() {
  let power = 1;
  // Obliczanie mocy z ulepsze≈Ñ klikania
  UPGRADES.filter(u => u.type === 'click').forEach((u, index) => {
    // Prosta logika: lvl ulepszenia w grze nie jest zapisywany per item w tej strukturze
    // upro≈õcimy to: clickLvl to mno≈ºnik globalny
  });
  // W tej wersji upro≈õcimy: Click Power to po prostu zmienna
  return Math.floor(1 + (game.clickLvl * 1.5) + (game.money * 0.0001)); // Dynamic power scaling
}

function getAutoPower() {
  let petBonus = 0;
  game.pets.forEach(pid => {
    let p = PETS.find(x => x.id === pid);
    if(p) petBonus += p.power;
  });
  return Math.floor((game.autoLvl * 2) + petBonus);
}

function formatNum(n) {
  if(n >= 1000000) return (n/1000000).toFixed(2) + 'M';
  if(n >= 1000) return (n/1000).toFixed(1) + 'k';
  return Math.floor(n);
}

function renderUI() {
  document.getElementById('money').innerText = '$' + formatNum(game.money);
  // Z≈Ço≈ºona logika dla click power w tej wersji V3 opiera siƒô na prostym modelu poni≈ºej dla czytelno≈õci
  // Tutaj clickPower obliczamy: baza + (lvl * mno≈ºnik)
  let cp = 1; 
  UPGRADES.forEach(u => {
     if(u.type === 'click') {
        // Sprawdzamy ile razy kupiono (dla uproszczenia w tablicy game trzymamy liczniki)
        if(!game.upgrades) game.upgrades = {};
        let count = game.upgrades[u.id] || 0;
        cp += count * u.basePow;
     }
  });
  
  document.getElementById('perClick').innerText = formatNum(cp);
  document.getElementById('autoSec').innerText = formatNum(getAutoPower());
  
  renderShop();
}

function renderShop() {
  const list = document.getElementById('shopList');
  list.innerHTML = '';

  if(currentTab === 'upgrades') {
    UPGRADES.forEach(u => {
      if(!game.upgrades) game.upgrades = {};
      let lvl = game.upgrades[u.id] || 0;
      let cost = Math.floor(u.baseCost * Math.pow(1.5, lvl));
      
      let html = `
        <div class="item">
          <div class="item-left">
            <div class="item-icon">${u.icon}</div>
            <div class="item-info">
              <h4>${u.name} <span style="font-size:11px; opacity:0.6">Lvl ${lvl}</span></h4>
              <p>+${u.basePow} ${u.type === 'click' ? 'Klik' : 'Auto'}</p>
            </div>
          </div>
          <button class="buy-btn ${game.money < cost ? 'locked' : ''}" onclick="buyUpgrade('${u.id}')">
            $${formatNum(cost)}
          </button>
        </div>`;
      list.innerHTML += html;
    });
  } 
  else if (currentTab === 'pets') {
    PETS.forEach(p => {
      let owned = game.pets.includes(p.id);
      let html = `
        <div class="item">
          <div class="item-left">
            <img src="${p.icon}" style="width:32px; height:32px; filter:drop-shadow(0 0 5px #fff);">
            <div class="item-info">
              <h4>${p.name}</h4>
              <p>+${p.power}/s Auto</p>
            </div>
          </div>
          <button class="buy-btn ${owned ? 'owned' : (game.money < p.cost ? 'locked' : '')}" onclick="buyPet('${p.id}')">
            ${owned ? 'Posiadasz' : '$'+formatNum(p.cost)}
          </button>
        </div>`;
      list.innerHTML += html;
    });
  }
  else if (currentTab === 'backgrounds') {
    BACKGROUNDS.forEach(b => {
      let owned = game.backgrounds.includes(b.id);
      let active = game.currentBg === b.id;
      let btnTxt = owned ? (active ? 'Aktywne' : 'Wybierz') : '$' + formatNum(b.cost);
      let btnClass = owned ? (active ? 'owned' : '') : (game.money < b.cost ? 'locked' : '');
      
      let html = `
        <div class="item">
          <div class="item-left">
            <div style="width:32px; height:32px; border-radius:4px; background:url('${b.img}') center/cover;"></div>
            <div class="item-info">
              <h4>${b.name}</h4>
            </div>
          </div>
          <button class="buy-btn ${btnClass}" onclick="${owned ? `selectBg('${b.id}')` : `buyBg('${b.id}')`}">
            ${btnTxt}
          </button>
        </div>`;
      list.innerHTML += html;
    });
  }
}

function switchTab(t) { currentTab = t; renderShop(); document.querySelectorAll('.tab').forEach(x => x.classList.remove('active')); event.target.classList.add('active'); }

// --- AKCJE ---

function buyUpgrade(id) {
  let u = UPGRADES.find(x => x.id === id);
  if(!game.upgrades) game.upgrades = {};
  let lvl = game.upgrades[id] || 0;
  let cost = Math.floor(u.baseCost * Math.pow(1.5, lvl));
  
  if(game.money >= cost) {
    game.money -= cost;
    game.upgrades[id] = lvl + 1;
    if(u.type === 'auto') game.autoLvl += u.basePow; // Uproszczenie dla auto
    renderUI();
    saveGame();
  }
}

function buyPet(id) {
  if(game.pets.includes(id)) return;
  let p = PETS.find(x => x.id === id);
  if(game.money >= p.cost) {
    game.money -= p.cost;
    game.pets.push(id);
    renderPets();
    renderUI();
    saveGame();
  }
}

function buyBg(id) {
  if(game.backgrounds.includes(id)) return;
  let b = BACKGROUNDS.find(x => x.id === id);
  if(game.money >= b.cost) {
    game.money -= b.cost;
    game.backgrounds.push(id);
    selectBg(id);
    saveGame();
  }
}

function selectBg(id) {
  game.currentBg = id;
  let bgObj = BACKGROUNDS.find(x => x.id === id);
  if(bgObj) {
    document.getElementById('global-bg').style.backgroundImage = `url('${bgObj.img}')`;
  }
  renderUI();
  saveGame();
}

function renderPets() {
  const zone = document.getElementById('activePets');
  if(game.pets.length === 0) {
    zone.innerHTML = '<div style="color:rgba(255,255,255,0.3); font-size:14px; margin:auto;">Kup pety, aby zobaczyƒá je tutaj!</div>';
    return;
  }
  zone.innerHTML = '';
  game.pets.forEach(pid => {
    let p = PETS.find(x => x.id === pid);
    let div = document.createElement('div');
    div.className = 'pet-card';
    div.innerHTML = `<img src="${p.icon}"><div class="pet-name">${p.name}</div>`;
    zone.appendChild(div);
  });
}

// --- KLIKANIE I AUTO ---

const btn = document.getElementById('clickBtn');
btn.addEventListener('mousedown', (e) => {
  let power = 1;
  UPGRADES.forEach(u => { if(u.type === 'click') power += (game.upgrades?.[u.id]||0) * u.basePow; });
  
  game.money += power;
  renderUI();

  // Efekt tekstu
  let float = document.createElement('div');
  float.className = 'float-text';
  float.innerText = '+' + formatNum(power);
  float.style.left = (e.clientX - 20) + 'px';
  float.style.top = (e.clientY - 50) + 'px';
  document.body.appendChild(float);
  setTimeout(() => float.remove(), 800);
});

// Auto Loop - dzia≈Ça co 100ms (p≈Çynniej)
setInterval(() => {
  let aps = getAutoPower();
  if(aps > 0) {
    // Dodajemy 1/10 warto≈õci co 100ms
    game.money += aps / 10;
    renderUI();
  }
}, 100);

// --- ZAPIS ---
function saveGame() { localStorage.setItem(DB_KEY, JSON.stringify(game)); }
function loadGame() {
  let d = localStorage.getItem(DB_KEY);
  if(d) {
    let parsed = JSON.parse(d);
    game = {...game, ...parsed};
    // Naprawa starych sejw√≥w
    if(!game.upgrades) game.upgrades = {};
  }
  
  // Za≈Çaduj t≈Ço
  let bgObj = BACKGROUNDS.find(x => x.id === game.currentBg);
  if(bgObj) document.getElementById('global-bg').style.backgroundImage = `url('${bgObj.img}')`;
  
  renderPets();
  renderUI();
}

// Inicjalizacja
loadGame();
</script>
</body>
</html>
