<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cash Kingdom ‚Äî Turbo Edition v2</title>
<style>
/* --- G≈Å√ìWNY STYL --- */
:root{
  --bg: #0e0e18;
  --card: #161625; /* Nieco ja≈õniejszy od t≈Ça */
  --accent: #37ff9a;
  --accent2: #5ecbff;
  --muted: #a3b0c6;
  --danger: #ff5f7e;
  --gold: #ffd700;
}
*{box-sizing:border-box;font-family:'Segoe UI', Inter, Roboto, sans-serif; user-select: none;}

html, body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  color: #fff;
}

body {
  background-color: var(--bg);
  background-position: center center;
  background-size: cover; /* T≈Ço na ca≈Çy ekran */
  background-attachment: fixed; /* T≈Ço nie przesuwa siƒô */
  background-repeat: no-repeat;
  transition: background-image 0.5s ease;
}

/* Ciemna nak≈Çadka, ≈ºeby tekst by≈Ç czytelny na jasnych t≈Çach */
#backgroundOverlay {
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.4); 
  z-index: 1;
  pointer-events: none;
}

.app {
  max-width: 1100px;
  height: 95vh;
  margin: 2vh auto;
  padding: 0 20px;
  display: grid;
  grid-template-columns: 1fr 380px; /* Panel gry | Sklep */
  grid-template-rows: auto 1fr auto;
  gap: 20px;
  position: relative;
  z-index: 2;
}

/* --- HEADER --- */
.header {
  grid-column: 1 / 3;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(10px);
  padding: 15px 25px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,0.1);
}
.title { font-size: 24px; font-weight: 800; color: var(--accent); display: flex; align-items: center; gap: 10px; }
.title img { width: 32px; }

/* --- G≈Å√ìWNY PANEL (Lewa strona) --- */
.mainPanel {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 30px;
}

/* Wielki przycisk dolara */
#dollarBtn {
  width: 240px;
  height: 240px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at 30% 30%, #fff, #baffd3, #00c462);
  cursor: pointer;
  box-shadow: 0 0 40px rgba(55, 255, 154, 0.4), inset -10px -10px 20px rgba(0,0,0,0.2);
  transition: transform 0.1s;
  position: relative;
}
#dollarBtn:active { transform: scale(0.95); }
#dollarBtn img { width: 140px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3)); }

/* Animacja klikniƒôcia */
.pop { animation: popAnim 0.3s ease; }
@keyframes popAnim { 50% { transform: scale(1.05); } }

.statsRow {
  display: flex;
  gap: 15px;
  width: 100%;
  justify-content: center;
}
.statBox {
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(5px);
  padding: 10px 20px;
  border-radius: 12px;
  text-align: center;
  min-width: 100px;
  border: 1px solid rgba(255,255,255,0.05);
}
.statVal { font-size: 22px; font-weight: bold; color: var(--accent); }
.statLabel { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }

/* Sekcja Pet√≥w (PodglƒÖd) */
.activePetsArea {
  grid-column: 1 / 3;
  min-height: 120px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  padding-bottom: 20px;
}

/* --- STYLIZACJA PET√ìW (Nowa) --- */
.petDisplay {
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  width: 90px;
  animation: floatPet 3s ease-in-out infinite; /* Animacja lewitowania */
}
/* Ka≈ºdy pet lewituje w nieco innym tempie */
.petDisplay:nth-child(odd) { animation-duration: 3.5s; }
.petDisplay:nth-child(even) { animation-duration: 4s; }

@keyframes floatPet {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-15px); }
}

.petIcon {
  font-size: 60px;
  filter: drop-shadow(0 0 15px rgba(255,255,255,0.4));
  transition: transform 0.3s;
}
.petDisplay:hover .petIcon { transform: scale(1.2) rotate(10deg); }
.petName { 
  background: rgba(0,0,0,0.7); 
  padding: 2px 8px; 
  border-radius: 10px; 
  font-size: 11px; 
  margin-top: 5px;
  border: 1px solid rgba(255,255,255,0.2);
}

/* --- PANEL SKLEPU (Prawa strona) --- */
.shopPanel {
  background: rgba(22, 22, 37, 0.95);
  border-radius: 20px;
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  box-shadow: -10px 0 30px rgba(0,0,0,0.5);
  border: 1px solid rgba(255,255,255,0.05);
  overflow: hidden;
}

.tabs { display: flex; gap: 5px; background: #0b0b14; padding: 5px; border-radius: 12px; }
.tab { 
  flex: 1; 
  text-align: center; 
  padding: 10px; 
  font-size: 13px; 
  border-radius: 8px; 
  cursor: pointer; 
  color: var(--muted);
  transition: 0.2s;
}
.tab:hover { background: rgba(255,255,255,0.05); }
.tab.active { background: var(--accent); color: #000; font-weight: bold; box-shadow: 0 0 10px var(--accent); }

#shopContent {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding-right: 5px; /* miejsce na scrollbar */
}
/* Pasek przewijania */
#shopContent::-webkit-scrollbar { width: 6px; }
#shopContent::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

/* Karta produktu */
.shopItem {
  background: rgba(255,255,255,0.03);
  padding: 12px;
  border-radius: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border: 1px solid transparent;
  transition: 0.2s;
}
.shopItem:hover { border-color: rgba(255,255,255,0.1); background: rgba(255,255,255,0.06); }

.itemInfo { display: flex; flex-direction: column; }
.itemName { font-weight: bold; color: #fff; font-size: 15px; }
.itemDesc { font-size: 12px; color: var(--muted); }
.itemBonus { color: var(--accent2); font-size: 12px; }

.buyBtn {
  background: linear-gradient(45deg, var(--accent2), var(--accent));
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  color: #000;
  font-size: 13px;
  min-width: 80px;
  transition: 0.2s;
  box-shadow: 0 4px 10px rgba(55, 255, 154, 0.2);
}
.buyBtn:active { transform: scale(0.95); }

/* Styl dla kupionego przedmiotu */
.buyBtn.owned {
  background: #333;
  color: #777;
  cursor: default;
  box-shadow: none;
  pointer-events: none;
}
.buyBtn.locked {
  background: #333;
  color: #aaa;
  cursor: not-allowed;
  opacity: 0.5;
}

/* Toast (Powiadomienia) */
.toast {
  position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
  background: #222; border: 1px solid #444; color: #fff;
  padding: 10px 20px; border-radius: 30px;
  font-size: 14px; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 100;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.toast.show { opacity: 1; bottom: 50px; }

</style>
</head>
<body>

<div id="backgroundOverlay"></div>

<div class="app">
  <div class="header">
    <div class="title">
      <img src="https://cdn-icons-png.flaticon.com/512/138/138292.png" alt="logo">
      Cash Kingdom <span style="font-weight:300; font-size:16px; margin-left:5px; opacity:0.7">Turbo Edition</span>
    </div>
    <div style="font-size:12px; color:var(--muted)">Autosave ON</div>
  </div>

  <div class="mainPanel">
    <div class="statsRow">
      <div class="statBox"><div class="statVal" id="moneyDisplay">$0</div><div class="statLabel">Got√≥wka</div></div>
      <div class="statBox"><div class="statVal" id="perClickDisplay">1</div><div class="statLabel">Za klik</div></div>
      <div class="statBox"><div class="statVal" id="autoDisplay">0/s</div><div class="statLabel">Auto</div></div>
    </div>

    <div id="dollarBtn"><img src="https://cdn-icons-png.flaticon.com/512/625/625595.png" alt="click"></div>
  </div>

  <div class="shopPanel">
    <div class="tabs">
      <div class="tab active" onclick="setTab('upgrades')">Ulepszenia</div>
      <div class="tab" onclick="setTab('pets')">Pety</div>
      <div class="tab" onclick="setTab('backgrounds')">T≈Ça</div>
    </div>
    <div id="shopContent">
      </div>
  </div>

  <div class="activePetsArea" id="petsContainer">
    <div style="color:rgba(255,255,255,0.1); font-style:italic;">Brak aktywnych pet√≥w...</div>
  </div>
</div>

<div id="toast" class="toast">Zapisano grƒô!</div>

<script>
/* --- KONFIGURACJA DANYCH --- */
const STATE_KEY = "cashkingdom_turbo_v4"; // Zmieniony klucz, by zresetowaƒá stary stan (v3)

// Domy≈õlny stan
let state = {
  money: 0,
  lifetime: 0,
  upgrades: {
    click: { level: 0, baseCost: 15, costMult: 1.5, add: 1, name: "Mocniejszy Klik" },
    auto: { level: 0, baseCost: 100, costMult: 1.4, add: 1, name: "Auto Kliker" },
    factory: { level: 0, baseCost: 1000, costMult: 1.6, add: 15, name: "Fabryka Monet" }
  },
  pets: {
    rabbit: { owned: false },
    frog:   { owned: false },
    cat:    { owned: false },
    dragon: { owned: false },
    unicorn:{ owned: false }
  },
  backgrounds: {
    base:   { owned: true }, // Domy≈õlne
    sea:    { owned: false },
    candy:  { owned: false },
    space:  { owned: false }
  },
  currentBg: 'base'
};

// Definicje obiekt√≥w (statyczne)
const PETS_DATA = {
  rabbit: { name: "Kr√≥lik Turbo", cost: 2000, mult: 0.5, icon: "üê∞", desc: "+50% do mno≈ºnika" },
  frog:   { name: "≈ªaba Mutant", cost: 15000, mult: 1.2, icon: "üê∏", desc: "+120% do mno≈ºnika" },
  cat:    { name: "Kot Alfa", cost: 80000, mult: 2.5, icon: "üê±", desc: "x2.5 Mno≈ºnik!" },
  dragon: { name: "Smok", cost: 500000, mult: 8.0, icon: "üêâ", desc: "Ogromny boost!" },
  unicorn:{ name: "Jednoro≈ºec", cost: 2000000, mult: 20.0, icon: "ü¶Ñ", desc: "Legenda" }
};

const BGS_DATA = {
  base:  { name: "Ciemno≈õƒá", cost: 0, mult: 0, css: "#0e0e18" },
  sea:   { name: "Atlantyda", cost: 50000, mult: 0.2, css: "url('https://images.unsplash.com/photo-1551099276-857508c2a33f?q=80&w=1920')"},
  candy: { name: "Cukierkowo", cost: 250000, mult: 0.4, css: "url('https://images.unsplash.com/photo-1518552632230-149fa8a5c370?q=80&w=1920')"},
  space: { name: "Kosmos", cost: 1000000, mult: 1.0, css: "url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=1920')"}
};

let currentTab = 'upgrades';

/* --- LOGIKA GRY --- */

function getMult() {
  let m = 1;
  // Bonus z pet√≥w
  for(let p in state.pets) {
    if(state.pets[p].owned) m += PETS_DATA[p].mult;
  }
  // Bonus z t≈Ça (tylko aktywnego? Nie, zazwyczaj w clickerach bonusy siƒô sumujƒÖ za posiadanie)
  // Tutaj zrobimy tak: bonus daje TYLKO aktualnie wybrane t≈Ço LUB wszystkie posiadane.
  // Zr√≥bmy, ≈ºe wszystkie POSIADANE t≈Ça dajƒÖ bonus pasywny.
  for(let b in state.backgrounds) {
    if(state.backgrounds[b].owned && BGS_DATA[b].cost > 0) m += BGS_DATA[b].mult;
  }
  return m;
}

function getPerClick() {
  let base = 1 + (state.upgrades.click.level * state.upgrades.click.add);
  return base * getMult();
}

function getAuto() {
  let base = (state.upgrades.auto.level * state.upgrades.auto.add) + 
             (state.upgrades.factory.level * state.upgrades.factory.add);
  return base * getMult();
}

function earn(amount) {
  state.money += amount;
  state.lifetime += amount;
  updateUI();
}

/* --- ZARZƒÑDZANIE UI --- */

function formatNum(num) {
  if (num >= 1000000) return (num/1000000).toFixed(2) + "M";
  if (num >= 1000) return (num/1000).toFixed(1) + "k";
  return Math.floor(num);
}

function updateUI() {
  document.getElementById('moneyDisplay').innerText = "$" + formatNum(state.money);
  document.getElementById('perClickDisplay').innerText = formatNum(getPerClick());
  document.getElementById('autoDisplay').innerText = formatNum(getAuto()) + "/s";
  
  // Od≈õwie≈º sklep tylko je≈õli co≈õ kupujemy (mo≈ºna zoptymalizowaƒá, ale przy tej skali ok)
  renderShop(); 
}

/* --- SYSTEM SKLEPU --- */

function setTab(tab) {
  currentTab = tab;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll(`.tab[onclick="setTab('${tab}')"]`).forEach(t => t.classList.add('active'));
  renderShop();
}

function renderShop() {
  const container = document.getElementById('shopContent');
  container.innerHTML = "";

  if (currentTab === 'upgrades') {
    for (let key in state.upgrades) {
      const upg = state.upgrades[key];
      const cost = Math.floor(upg.baseCost * Math.pow(upg.costMult, upg.level));
      
      const div = document.createElement('div');
      div.className = 'shopItem';
      div.innerHTML = `
        <div class="itemInfo">
          <div class="itemName">${upg.name} <span style="font-size:11px; opacity:0.6">Lvl ${upg.level}</span></div>
          <div class="itemDesc">+${upg.add} bazowej mocy</div>
        </div>
        <button class="buyBtn ${state.money < cost ? 'locked' : ''}" onclick="buyUpgrade('${key}')">$${formatNum(cost)}</button>
      `;
      container.appendChild(div);
    }
  } 
  
  else if (currentTab === 'pets') {
    for (let key in PETS_DATA) {
      const pet = PETS_DATA[key];
      const owned = state.pets[key].owned;
      
      const div = document.createElement('div');
      div.className = 'shopItem';
      div.innerHTML = `
        <div class="itemInfo">
          <div class="itemName">${pet.icon} ${pet.name}</div>
          <div class="itemDesc">${pet.desc}</div>
        </div>
        <button class="buyBtn ${owned ? 'owned' : (state.money < pet.cost ? 'locked' : '')}" 
                onclick="buyPet('${key}')">
          ${owned ? 'Posiadasz' : '$' + formatNum(pet.cost)}
        </button>
      `;
      container.appendChild(div);
    }
  }
  
  else if (currentTab === 'backgrounds') {
    for (let key in BGS_DATA) {
      const bg = BGS_DATA[key];
      const owned = state.backgrounds[key].owned;
      const isActive = state.currentBg === key;
      
      let btnText = "$" + formatNum(bg.cost);
      let btnClass = "";
      let action = `buyBg('${key}')`;

      if (owned) {
        if (isActive) {
          btnText = "Aktywne";
          btnClass = "owned";
        } else {
          btnText = "Wybierz";
          action = `selectBg('${key}')`;
        }
      } else if (state.money < bg.cost) {
        btnClass = "locked";
      }

      const div = document.createElement('div');
      div.className = 'shopItem';
      div.innerHTML = `
        <div class="itemInfo">
          <div class="itemName">${bg.name}</div>
          <div class="itemBonus">Bonus: +${bg.mult*100}%</div>
        </div>
        <button class="buyBtn ${btnClass}" onclick="${action}">${btnText}</button>
      `;
      container.appendChild(div);
    }
  }
}

/* --- AKCJE ZAKUPU --- */

function buyUpgrade(key) {
  const upg = state.upgrades[key];
  const cost = Math.floor(upg.baseCost * Math.pow(upg.costMult, upg.level));
  if (state.money >= cost) {
    state.money -= cost;
    upg.level++;
    saveState();
    updateUI();
  }
}

function buyPet(key) {
  if (state.pets[key].owned) return; // Zabezpieczenie
  const cost = PETS_DATA[key].cost;
  if (state.money >= cost) {
    state.money -= cost;
    state.pets[key].owned = true;
    renderPets();
    saveState();
    updateUI();
    showToast("Kupiono nowego peta!");
  }
}

function buyBg(key) {
  if (state.backgrounds[key].owned) return;
  const cost = BGS_DATA[key].cost;
  if (state.money >= cost) {
    state.money -= cost;
    state.backgrounds[key].owned = true;
    selectBg(key); // Automatycznie wybierz po kupnie
    saveState();
    updateUI();
  }
}

function selectBg(key) {
  if (!state.backgrounds[key].owned) return;
  state.currentBg = key;
  applyBackground();
  saveState();
  updateUI();
}

/* --- FUNKCJE POMOCNICZE --- */

function renderPets() {
  const container = document.getElementById('petsContainer');
  container.innerHTML = "";
  let anyPet = false;
  
  for(let key in state.pets) {
    if(state.pets[key].owned) {
      anyPet = true;
      const p = PETS_DATA[key];
      const div = document.createElement('div');
      div.className = 'petDisplay';
      div.innerHTML = `<div class="petIcon">${p.icon}</div><div class="petName">${p.name}</div>`;
      container.appendChild(div);
    }
  }
  
  if(!anyPet) container.innerHTML = '<div style="color:rgba(255,255,255,0.1); font-style:italic;">Brak aktywnych pet√≥w...</div>';
}

function applyBackground() {
  const bgData = BGS_DATA[state.currentBg];
  if(bgData.css.includes('url')) {
    document.body.style.backgroundImage = bgData.css;
    document.body.style.backgroundColor = '#000';
  } else {
    document.body.style.backgroundImage = 'none';
    document.body.style.backgroundColor = bgData.css;
  }
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.innerText = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

/* --- SAVE / LOAD SYSTEM --- */
function saveState() {
  localStorage.setItem(STATE_KEY, JSON.stringify(state));
}

function loadState() {
  const saved = localStorage.getItem(STATE_KEY);
  if (saved) {
    try {
      const parsed = JSON.parse(saved);
      // Scalanie ze stanem domy≈õlnym na wypadek nowych p√≥l
      state = { ...state, ...parsed };
      // G≈Çƒôbokie scalanie dla obiekt√≥w (≈ºeby nie nadpisaƒá nowych upgrad√≥w starymi nullami je≈õli zmienimy strukturƒô)
      if(parsed.upgrades) {
         for(let k in parsed.upgrades) state.upgrades[k] = {...state.upgrades[k], ...parsed.upgrades[k]};
      }
      if(parsed.pets) {
         for(let k in parsed.pets) state.pets[k] = {...state.pets[k], ...parsed.pets[k]};
      }
      if(parsed.backgrounds) {
         for(let k in parsed.backgrounds) state.backgrounds[k] = {...state.backgrounds[k], ...parsed.backgrounds[k]};
      }
    } catch(e) { console.error("Save file corrupted"); }
  }
}

/* --- INITIALIZATION --- */
const btn = document.getElementById('dollarBtn');

btn.addEventListener('mousedown', () => {
  earn(getPerClick());
  btn.classList.remove('pop');
  void btn.offsetWidth; // trigger reflow
  btn.classList.add('pop');
});

// Auto Clicker Loop
setInterval(() => {
  let a = getAuto();
  if (a > 0) {
    earn(a);
    // Opcjonalnie: wizualna aktualizacja got√≥wki bez pe≈Çnego renderowania sklepu dla wydajno≈õci
    document.getElementById('moneyDisplay').innerText = "$" + formatNum(state.money);
  }
}, 1000);

// Auto Save
setInterval(() => {
  saveState();
}, 10000);

// Start
loadState();
renderPets();
applyBackground();
updateUI(); // Pierwsze rysowanie
setTab('upgrades');

</script>
</body>
</html>
